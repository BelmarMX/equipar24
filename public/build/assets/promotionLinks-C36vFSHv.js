import{D as i}from"./common-BtanXuX7.js";import{A as r}from"./alerts-ClLvi9ZR.js";import{a as l}from"./axios-CCb-kr4I.js";import"./sweetalert2.esm.all-Br4OTrmy.js";const d=e=>{e?$("[data-loader]").removeClass("hidden"):$("[data-loader]").addClass("hidden")};$(document).ready(function(){$(document).on("click","#btn-filter",function(e){e.preventDefault(),$("#promotionLinks-table").removeClass("hidden").addClass("display"),$("#promotionLinks-table").DataTable().destroy(),d(!0);let a={product_brand_id:$("#product_brand_id").val()||null,product_category_id:$("#product_category_id").val()||null,product_subcategory_id:$("#product_subcategory_id").val()||null,is_featured:$("#is_featured").is(":checked")?1:0,with_freight:$("#with_freight").is(":checked")?1:0};$("#promotionLinks-table").DataTable({...i,pageLength:-1,ajax:{...i.ajax,url:url_route,data:a,error:n=>{$("#btn-update").removeClass("display").addClass("hidden"),d(!1),r.error("Lo sentimos, la tabla no pudo ser cargada","Es necesario contactar a un administrador.")}},columns:[...i.columns,{data:"title"},{data:"category"},{data:"subcategory"},{data:"brand"},{data:"old_link",className:"text-center"},{data:"new_link",className:"text-center"},{data:"prices",className:"text-right"}],drawCallback:n=>{$("#link_change_controller").removeClass("hidden").addClass("display"),$("#btn-update-wrapper").removeClass("hidden").addClass("display"),d(!1)}})}),$(document).on("click","#btn-change-links",function(e){e.preventDefault(),$.each($('[data-link-type="new_link"]'),function(a){switch($("#change_type").val()){case"link":$(this).prop("checked",!0);break;default:$(this).prop("checked",!1);break}})}),$(document).on("click","#btn-update",function(e){e.preventDefault(),d(!0);let a=[];$.each($('[data-link-type="new_link"]'),function(n){let t=$(this).attr("data-original-id"),s=$(this).is(":checked")?1:0;a.push({id:t,linked:s})}),r.confirm(`Vas a actualizar ${a.length} productos, esta acción no se podrá revertir`,n=>{l.post(update_massive_route,{dataset:a}).then(({status:t,data:s})=>{if(s.success){$("#btn-filter").click(),r.success(s.message);return}r.error(s.message)}).catch(t=>{r.error(t.code+": "+t.message,"Lo sentimos, no se pudieron actualizar los fletes.")}).finally(()=>d(!1))})})});
